---
id: 212
topics: [21, 2]
source: 10
---

# Parts

## a

A set of cities V is connected by a network of roads G(V,E). There is a proposal to add one new road. A set C contains candidate pairs of cities. Each candidate road has an associated length. You want to choose the road that maximizes the decrease in driving distance between city $s$ and city $t$. Give an efficient algorithm with run time $O(|E| \log |V| + |C|)$.

**Answer:** Algorithm: 1) Run Dijkstra from $s$ to find shortest distances from $s$ to all other cities. 2) Run Dijkstra from $t$ to find shortest distances from $t$ to all other cities. 3) For every candidate pair $\{u,v\} \in C$, the shortest path using road $(u,v)$ is $\min(\text{dist}(s,u) + \text{length}(u,v) + \text{dist}(t,v),\ \text{dist}(s,v) + \text{length}(u,v) + \text{dist}(t,u))$. 4) Choose the candidate that produces the shortest new distance. If it's shorter than $\text{dist}(s,t)$, select it; otherwise no road helps. Complexity: Two runs of Dijkstra take $O(|E| \log |V|)$, and scanning all candidates takes $O(|C|)$, giving $O(|E| \log |V| + |C|)$ total.
