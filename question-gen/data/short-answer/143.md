---
id: 143
topics: [13, 20]
source: 4
---

# Background

You have $n$ heavy iron chains of weights $W_1, W_2, \ldots, W_n$. You want to connect them together to form one long chain. Every day you connect two existing chains into one (so you have one less chain), repeating for $n - 1$ days. To connect two chains of weights $W$ and $W'$ into one chain of weight $W + W'$, you burn $100 \cdot (W + W')$ calories. You want to minimize total calories burned. Your algorithm should run asymptotically faster than $\Theta(n^2)$.

# Parts

## a

Design an efficient algorithm to decide the order in which to connect all the chains to minimize the total calories burned. Analyze the time complexity.

**Answer:** Use a min-heap. Insert all weights $W_1, W_2, \ldots, W_n$ into a min-heap. Iteratively: pop the two lightest chains $W$ and $W'$, add $100 \cdot (W + W')$ to total calories, insert $W + W'$ back into the heap. Repeat until one chain remains. The intuition is that combining lighter chains first causes them to contribute to the total cost more times, while the heaviest chains are saved for last. Building the initial min-heap takes $O(n)$. Each of the $n - 1$ iterations performs two extract-min and one insert, each $O(\log n)$. Total: $O(n \log n)$.
