---
id: 328
topics: [16]
source: 18
---

# Background

You are given a connected graph $G$ with MST $T$, and a new edge $e = (v,w)$ with cost $c$ is added.

# Parts

## a

How do you efficiently test whether $T$ remains the MST after adding edge $e$?

**Answer:** Find the path from $v$ to $w$ in $T$ (using BFS/DFS on the tree in $O(|V|)$). Let $e_{\max}$ be the most expensive edge on this path. If $c < c(e_{\max})$, $T$ is no longer the MST. If $c \ge c(e_{\max})$, $T$ remains the MST (by the Cycle Property, the new edge is the most expensive on the cycle and won't be in any MST).

## b

If $T$ is no longer the MST, how do you update it?

**Answer:** The new MST is $T' = T \setminus \{e_{\max}\} \cup \{e\}$: remove the most expensive edge on the $v$-$w$ path in $T$ and add the new edge. This takes $O(|V|)$ time.
