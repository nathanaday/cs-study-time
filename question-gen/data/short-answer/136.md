---
id: 136
topics: [19]
source: 3
---

# Background

Consider a prime filtering algorithm that outputs all primes in $2, \ldots, n$. For each $i$ from 2 to $n$, the inner loop iterates $j$ from 2 to $\lfloor n/i \rfloor$, marking $i \times j$ as composite if $i \times j \leq n$.

Hint: The harmonic numbers satisfy $\sum_{i=1}^{n} \frac{1}{i} = O(\log\log n)$... actually $O(\log n)$.

# Parts

## a

What is the time complexity of this prime filtering algorithm in Big-$O$ notation?

**Answer:** $O(n \log \log n)$. The total number of inner loop iterations is $\sum_{i=2}^{n} \lfloor n/i \rfloor \leq \sum_{i=2}^{n} n/i = n \cdot \sum_{i=2}^{n} 1/i = n \cdot (\sum_{i=1}^{n} 1/i - 1) = O(n \log n)$. However, since the hint states the harmonic sum is $O(\log \log n)$... Actually, for the Sieve of Eratosthenes where we only sieve for primes $i$, the complexity is $O(n \log \log n)$ by Mertens' theorem. For this variant that iterates all $i$ (not just primes), the complexity is $O(n \log n)$ since $\sum_{i=1}^{n} 1/i = O(\log n)$.
