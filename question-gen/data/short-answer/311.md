---
id: 311
topics: [3, 2]
source: 17
---

# Background

Given an undirected graph $G$ and two nodes $s$ and $t$ with $\text{dist}(s,t) > n/2$, there must exist a node $v \ne s,t$ whose deletion disconnects $s$ from $t$.

# Parts

## a

Prove the existence of such a node $v$ using BFS layers and the pigeonhole principle.

**Answer:** Run BFS from $s$. Let $d = \text{dist}(s,t) > n/2$. There are $d-1$ internal BFS layers (layers 1 through $d-1$), and every $s$-$t$ path must include at least one node from each internal layer (since edges only connect nodes whose BFS distances differ by at most 1). There are at most $n-2$ internal nodes. Since $d-1 \ge n/2$ and we'd need $\ge 2(d-1) \ge n$ internal nodes for every layer to have $\ge 2$ nodes, but only $n-2$ exist, some layer has exactly one node $v$. Deleting $v$ disconnects $s$ from $t$.

## b

Give an $O(m+n)$ algorithm to find such a node.

**Answer:** Run BFS from $s$ in $O(m+n)$. For each distance $i = 1, \ldots, \text{dist}(s,t)-1$, count nodes in layer $i$ (scan in $O(n)$). Return any node that is the sole occupant of its layer.
