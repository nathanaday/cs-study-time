---
id: 130
topics: [3, 4]
source: 3
---

# Background

Let $G = (V, E)$ be an undirected graph, and let vertex $u$ in $V$ be a designated root vertex. Suppose that running a DFS starting at $u$ produces a DFS tree $T$ that spans all vertices of $G$. Suppose further that running a BFS starting at the same root $u$ produces a BFS tree that is identical to $T$.

# Parts

## a

Prove, by contradiction, that $G = T$. In other words, show that $G$ cannot contain any edges that are not part of the tree $T$. (Hint: For any edge $(x, y)$ in $E$, how much can the BFS levels of $x$ and $y$ differ in $T$? What are the possible relative positions of $x$ and $y$ in the DFS tree $T$?)

**Answer:** Assume $G$ contains an edge $e = (x, y)$ not in $T$. Since $T$ is a DFS tree and $(x, y)$ is not a tree edge, one of $x$ or $y$ must be an ancestor of the other in $T$. Since $T$ is also a BFS tree, for any edge $(x, y)$ in $G$, the BFS layers $L_i$ and $L_j$ of $x$ and $y$ satisfy $|i - j| \leq 1$. Since one is an ancestor of the other in the DFS tree, we have $i \neq j$, so $|i - j| = 1$. But if one of $x, y$ is the ancestor of the other and their layers differ by exactly 1, the edge $(x, y)$ must be a tree edge in $T$ (it connects a parent to child). This contradicts the assumption that $e$ is not in $T$. Therefore $G$ cannot contain any non-tree edges, so $G = T$.
