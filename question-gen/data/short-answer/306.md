---
id: 306
topics: [4, 2]
source: 17
---

# Background

You need to detect whether an undirected graph contains a cycle, and if so, output one cycle. The algorithm should run in $O(m+n)$ time.

# Parts

## a

Describe how DFS can detect and extract a cycle in an undirected graph.

**Answer:** Run DFS maintaining a parent array. When exploring neighbors of node $u$, if we encounter a visited node $v$ that is not $u$'s parent, we have found a cycle. The cycle consists of the edge $(u,v)$ plus the path from $v$ to $u$ in the DFS tree (traced via parent pointers). If DFS completes without finding such an edge, the graph is acyclic (a forest).

## b

Why does this run in $O(m+n)$ time?

**Answer:** DFS visits each node and each edge exactly once. Maintaining and checking parent pointers is $O(1)$ per edge. Extracting the cycle (if found) traces parent pointers at most $n$ times. Total: $O(m+n)$.
