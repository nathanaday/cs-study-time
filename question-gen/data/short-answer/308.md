---
id: 308
topics: [5, 3]
source: 17
---

# Background

You have $n$ butterfly specimens, each belonging to one of two species. For $m$ pairs, you have a judgment of "same" (same species) or "different" (different species). You need an $O(m+n)$ algorithm to determine whether the judgments are consistent.

# Parts

## a

How does this problem reduce to bipartite graph checking?

**Answer:** Build a graph with $n$ nodes and $m$ edges, each labeled 'same' or 'different'. Run BFS from each unvisited node. Assign the start node label $A$. For each neighbor $w$ of node $v$: if the edge is 'same', assign $w$ the same label as $v$; if 'different', assign the opposite label. If a conflict arises (a node's required label contradicts its existing label), the judgments are inconsistent.

## b

Why is this equivalent to 2-colorability?

**Answer:** 'Same' edges require equal labels (same color) and 'different' edges require opposite labels (different colors). A valid labeling exists if and only if no odd-length cycle of constraints arises. BFS detects this in $O(m+n)$ time, exactly as in the standard bipartite check.
