---
id: 223
topics: [21]
source: 11
---

# Background

Suppose that you want to get from vertex $s$ to vertex $t$ in a connected undirected graph $G = (V, E)$ with positive edge costs, but you would like to stop by vertex $u$ if it is possible to do so without increasing the length of your path by more than a factor of $\alpha$.

# Parts

## a

Describe an efficient algorithm in $O(|E| \log |V|)$ time that would determine an optimal $s$-$t$ path given your preference for stopping at $u$ along the way if doing so is not prohibitively costly.

**Answer:** Run Dijkstra's algorithm twice: once from $s$ to find shortest distances to all nodes, and once from $u$ to find shortest distances from $u$ to all nodes (since the graph is undirected, this also gives distances to $u$). The shortest path from $s$ to $t$ through $u$ has length $\text{dist}(s,u) + \text{dist}(u,t)$. Compare this with $\alpha \cdot \text{dist}(s,t)$. If the path through $u$ costs at most $\alpha \cdot \text{dist}(s,t)$, return the path through $u$; otherwise return the direct shortest path.

## b

Show that your algorithm runs in $O(|E| \log |V|)$.

**Answer:** Since the graph has positive edge weights, we use Dijkstra's algorithm with a binary heap. Each run of Dijkstra takes $O(|E| \log |V|)$. We run it twice (from $s$ and from $u$), giving total time $2 \cdot O(|E| \log |V|) = O(|E| \log |V|)$.
