---
id: 312
topics: [3]
source: 17
---

# Background

Given an undirected graph $G$ and two nodes $v$ and $w$, you want to count the number of shortest $v$-$w$ paths in $O(m+n)$ time.

# Parts

## a

Describe the algorithm using a modified BFS.

**Answer:** Run BFS from $v$. For each node $u$, maintain $\text{dist}[u]$ (shortest distance from $v$) and $\sigma[u]$ (number of shortest paths from $v$ to $u$). Initialize $\text{dist}[v]=0$, $\sigma[v]=1$. When processing node $u$ and encountering neighbor $x$: if $x$ is undiscovered, set $\text{dist}[x] = \text{dist}[u]+1$ and $\sigma[x] = \sigma[u]$; if $\text{dist}[x] = \text{dist}[u]+1$ (another shortest path found), add $\sigma[u]$ to $\sigma[x]$. The answer is $\sigma[w]$.
