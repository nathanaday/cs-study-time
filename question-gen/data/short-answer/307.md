---
id: 307
topics: [8, 7]
source: 17
---

# Background

Given a directed graph $G$, you want an $O(m+n)$ algorithm that either outputs a topological ordering (proving $G$ is a DAG) or outputs a cycle (proving $G$ is not a DAG).

# Parts

## a

Describe an algorithm based on Kahn's algorithm (iterative in-degree reduction) that achieves this.

**Answer:** Compute in-degrees for all nodes. Initialize a queue $S$ with all nodes of in-degree 0. Repeatedly remove a node from $S$, add it to the topological order, and decrement the in-degree of its neighbors (adding any that reach 0 to $S$). If all $n$ nodes are processed, output the topological order. If not, the remaining nodes (all with in-degree $\ge 1$ in their induced subgraph) contain a cycle.

## b

When a cycle exists (count $< n$), how do you extract the actual cycle from the remaining nodes?

**Answer:** Pick any remaining node $u$. Follow incoming edges backward: from $u$, go to a predecessor $v$ (which also has positive in-degree), then to a predecessor of $v$, and so on. Since the remaining subgraph is finite and every node has at least one incoming edge, this walk must eventually revisit a node. The portion from the first repeated node back to itself is a cycle. This takes $O(n)$ time.
