---
id: 157
topics: [21, 6]
source: 7
---

# Background

Hardy wants to run from home to work in San Francisco. He prefers a route that goes entirely uphill and then entirely downhill. The city map has $k$ intersections and $m$ road segments (each fully uphill or fully downhill), with known lengths and elevations at every intersection.

# Parts

## a

Give an efficient algorithm to find the shortest path (route) that meets Hardy's specifications (uphill then downhill). If no such path exists, the algorithm should determine this. Justify your answer.

**Answer:** Model the map as a directed graph where edge direction indicates uphill. Run Dijkstra's algorithm from Home using only uphill edges to find shortest uphill distances to all reachable nodes (set $S_1$). Run Dijkstra's algorithm from Work using only uphill edges (reverse of downhill from the runner's perspective) to find shortest uphill distances from Work to all reachable nodes (set $S_2$). Let $S = S_1 \cap S_2$ (nodes reachable uphill from both Home and Work), excluding Home and Work themselves. If $S$ is empty, no valid path exists. Otherwise, for each node $j$ in $S$, compute the total distance: (shortest uphill from Home to $j$) + (shortest uphill from Work to $j$, which equals shortest downhill from $j$ to Work). Select the node $j$ that minimizes this sum. The optimal route is: uphill from Home to $j$, then downhill from $j$ to Work.
